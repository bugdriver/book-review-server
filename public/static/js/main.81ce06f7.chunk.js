(this["webpackJsonpbook-review"]=this["webpackJsonpbook-review"]||[]).push([[0],{17:function(e,t,n){e.exports=n.p+"static/media/delete.650cdc57.svg"},18:function(e,t,n){e.exports=n.p+"static/media/pencil.aa0b5ae2.svg"},19:function(e,t,n){e.exports=n(31)},24:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(15),r=n.n(i),o=(n(24),n(3)),l=n(7),u=n(1),s=function(e){return c.a.createElement("div",null,c.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=48185bdb82c854d22f89"},"Login"))},m=function(e){var t=e.loginDetails;if(t.isLogin){var n=t.user;return c.a.createElement("div",{className:"navbar"},c.a.createElement("div",null,c.a.createElement(l.b,{to:"/"},c.a.createElement("h3",null,"Reader's Junction"))),c.a.createElement("div",null,c.a.createElement("button",{className:"btnlink",onClick:e.handleLogout},"Logout"),c.a.createElement("span",null,n.login)))}return c.a.createElement("div",{className:"navbar"},c.a.createElement("div",null,c.a.createElement(l.b,{to:"/"},c.a.createElement("h3",null,"Reader's Junction"))),c.a.createElement("div",null,c.a.createElement(s,null)))},v=function(e,t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},d=function(){return new Promise((function(e,t){fetch("/api/getUser").then((function(n){var a=n.json();403!==n.status?e(a):t(a)})).catch((function(e){t(e)}))}))},f=function(){return new Promise((function(e,t){fetch("/api/getBooks").then((function(t){e(t.json())}))}))},E=function(e){return new Promise((function(t,n){fetch("/api/getBook?bookId=".concat(e)).then((function(e){t(e.json())})).catch((function(e){n(e)}))}))},b=function(){return v("/api/logout")},w=function(e){return new Promise((function(t,n){fetch("/api/getReviewOfBook?bookId=".concat(e)).then((function(e){t(e.json())}))}))},h=function(e){return fetch(e).then((function(e){return e.blob()})).then((function(e){return function(e){return new Promise((function(t,n){var a=new FileReader;a.onerror=n,a.onload=function(){t(a.result)},a.readAsDataURL(e)}))}(e)}))},g=function(e){return v("/api/deleteReview",{reviewId:e})},p=function(e,t){return v("/api/addReview",{bookId:e,reviewText:t})},k=function(e,t){return v("/api/updateReview",{reviewId:e,reviewText:t})},j=(n(30),function(e){var t=e.id,n=e.frontimage,i=e.title,r=Object(a.useState)(""),u=Object(o.a)(r,2),s=u[0],m=u[1];return Object(a.useEffect)((function(){h(n).then(m)}),[n]),c.a.createElement("div",{className:"book-card"},c.a.createElement(l.b,{to:"/book/".concat(t)},c.a.createElement("img",{src:s,alt:"Avatar",className:"book-card-img"})),c.a.createElement("div",{className:"book-detail"},c.a.createElement("h4",null,c.a.createElement("b",null,i))))}),N=function(e){var t=Object(a.useState)([]),n=Object(o.a)(t,2),i=n[0],r=n[1];Object(a.useEffect)((function(){f().then(r)}),[]);var l=i.map((function(e){return c.a.createElement(j,Object.assign({},e,{key:e.id}))}));return c.a.createElement("div",{className:"book-list-container"},l)},O=n(17),C=n.n(O),R=function(e){var t=e.onDelete,n=e.onCancel;return c.a.createElement("div",{className:"modal"},c.a.createElement("div",{className:"popup-box"},c.a.createElement("div",{className:"popup-heading"},"Do you want to delete review ?"),c.a.createElement("div",{className:"popup-btn"},c.a.createElement("button",{className:"danger-btn",onClick:t},"Delete"),c.a.createElement("button",{className:"cancel-btn",onClick:n},"Cancel"))))},x=function(e){var t=Object(a.useState)(!1),n=Object(o.a)(t,2),i=n[0],r=n[1],l=function(){r(!i)};return c.a.createElement("div",null,i&&c.a.createElement(R,{onDelete:e.onClick,onCancel:l}),c.a.createElement("img",{className:"review-delete-btn",onClick:l,src:C.a,alt:"Delete review"}))},D=function(e){var t=Object(a.useState)(e.reviewText),n=Object(o.a)(t,2),i=n[0],r=n[1];return c.a.createElement("div",{className:"update-review-container"},c.a.createElement("textarea",{value:i,className:"post-review-textArea",onChange:function(e){r(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("button",{className:"update-review-btn",onClick:function(){return e.updateReview(i)}},"Update Review"),c.a.createElement("button",{className:"cancel-review-btn",onClick:e.cancelEditMode},"Cancel")))},S=n(18),L=n.n(S),I=function(e){var t=e.reviewid,n=e.username,i=e.reviewtext,r=e.reviewdate,l=e.loginDetails,u=l.user,s=l.isLogin,m=Object(a.useState)(!1),v=Object(o.a)(m,2),d=v[0],f=v[1],E=function(){f(!d)},b=d?c.a.createElement(D,{reviewText:i,updateReview:function(n){k(t,n).then((function(){e.updateReview(),E()}))},cancelEditMode:E}):c.a.createElement("div",{className:"review-text"},i);return c.a.createElement("div",{className:"review-box"},c.a.createElement("div",{className:"review-header"},c.a.createElement("b",null,c.a.createElement("i",null,n)),s&&u.login===n&&c.a.createElement("div",{className:"review-action-btn"},c.a.createElement(x,{onClick:function(){g(t).then((function(){e.updateReview()}))}}),c.a.createElement("img",{className:"review-edit-btn",onClick:E,src:L.a,alt:"Edit review"}))),b,c.a.createElement("div",{className:"review-time"},c.a.createElement("span",null,new Date(r).toUTCString())))},y=function(e){var t=e.bookId,n=Object(a.useState)(""),i=Object(o.a)(n,2),r=i[0],l=i[1];return c.a.createElement("div",{className:"post-review-container"},c.a.createElement("textarea",{value:r,className:"post-review-textArea",onChange:function(e){l(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("button",{className:"post-review-btn",onClick:function(){p(t,r).then((function(){e.updateReview(),l("")}))}},"Post Review")))},P=function(e){var t=e.loginDetails.isLogin,n=Object(u.f)().bookId,i=Object(a.useState)({}),r=Object(o.a)(i,2),l=r[0],s=r[1],m=Object(a.useState)([]),v=Object(o.a)(m,2),d=v[0],f=v[1],b=Object(a.useState)(""),g=Object(o.a)(b,2),p=g[0],k=g[1],j=function(){w(n).then(f)};return Object(a.useEffect)((function(){E(n).then(s),w(n).then(f)}),[n]),Object(a.useEffect)((function(){l.frontimage&&h(l.frontimage).then(k)}),[l.frontimage]),c.a.createElement("div",null,c.a.createElement("div",{className:"book-container"},c.a.createElement("img",{src:p,alt:l.title}),c.a.createElement("div",{className:"detail"},c.a.createElement("h2",null,l.title),c.a.createElement("p",null,"by ",l.writer),c.a.createElement("p",null,d.length," review",d.length>1?"s":""))),c.a.createElement("div",{className:"review-container"},d.map((function(t){return c.a.createElement(I,Object.assign({key:t.reviewid},t,{updateReview:j,loginDetails:e.loginDetails}))}))),c.a.createElement("div",null,t&&c.a.createElement(y,{bookId:n,updateReview:j})))};var T=function(){var e=Object(a.useState)({isLogin:!1,user:null}),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(a.useEffect)((function(){d().then((function(e){e&&i({isLogin:!0,user:e})})).catch((function(e){i({isLogin:!1,user:null})}))}),[]),c.a.createElement(l.a,null,c.a.createElement(m,{loginDetails:n,handleLogout:function(){b().then((function(){i({isLogin:!1,user:null})}))}}),c.a.createElement(u.c,null,c.a.createElement(u.a,{exact:!0,path:"/"},c.a.createElement(N,null)),c.a.createElement(u.a,{path:"/book/:bookId"},c.a.createElement(P,{loginDetails:n}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.81ce06f7.chunk.js.map