(this["webpackJsonpbook-review"]=this["webpackJsonpbook-review"]||[]).push([[0],{17:function(e,t,n){e.exports=n.p+"static/media/delete.650cdc57.svg"},18:function(e,t,n){e.exports=n.p+"static/media/pencil.aa0b5ae2.svg"},19:function(e,t,n){e.exports=n(31)},24:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(15),l=n.n(r),o=(n(24),n(1)),i=n(7),u=n(2),s=function(e){return c.a.createElement("div",null,c.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=48185bdb82c854d22f89"},"Login"))},m=c.a.createContext({isLogin:!1,user:null}),d=function(e,t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},v=function(){return new Promise((function(e,t){fetch("/api/getUser").then((function(n){var a=n.json();403!==n.status?e(a):t(a)})).catch((function(e){t(e)}))}))},f=function(){return new Promise((function(e,t){fetch("/api/getBooks").then((function(t){e(t.json())}))}))},b=function(e){return new Promise((function(t,n){fetch("/api/getBook?bookId=".concat(e)).then((function(e){t(e.json())})).catch((function(e){n(e)}))}))},E=function(){return d("/api/logout")},p=function(e){return new Promise((function(t,n){fetch("/api/getReviewOfBook?bookId=".concat(e)).then((function(e){t(e.json())}))}))},h=function(e){return fetch(e).then((function(e){return e.blob()})).then((function(e){return function(e){return new Promise((function(t,n){var a=new FileReader;a.onerror=n,a.onload=function(){t(a.result)},a.readAsDataURL(e)}))}(e)}))},w=function(e){return d("/api/deleteReview",{reviewId:e})},g=function(e,t){return d("/api/addReview",{bookId:e,reviewText:t})},k=function(e,t){return d("/api/updateReview",{reviewId:e,reviewText:t})},j=function(e){var t=Object(a.useContext)(m),n=Object(o.a)(t,2),r=n[0],l=n[1];Object(a.useEffect)((function(){v().then((function(e){e&&l({isLogin:!0,user:e})})).catch((function(e){l({isLogin:!1,user:null})}))}),[l]);if(r.isLogin){var u=r.user;return c.a.createElement("div",{className:"navbar"},c.a.createElement("div",{className:"navbar-right"},c.a.createElement(i.b,{to:"/"},c.a.createElement("h3",null,"Reader's Junction")),c.a.createElement(i.c,{to:"/addBook",activeClassName:"selectedLink"},c.a.createElement("p",null,"Add Book"))),c.a.createElement("div",null,c.a.createElement("button",{className:"btnlink",onClick:function(){E().then((function(){l({isLogin:!1,user:null})}))}},"Logout"),c.a.createElement("span",null,u.login)))}return c.a.createElement("div",{className:"navbar"},c.a.createElement("div",null,c.a.createElement(i.b,{to:"/"},c.a.createElement("h3",null,"Reader's Junction"))),c.a.createElement("div",null,c.a.createElement(s,null)))},O=(n(30),n(17)),N=n.n(O),C=function(e){var t=e.onDelete,n=e.onCancel;return c.a.createElement("div",{className:"modal"},c.a.createElement("div",{className:"popup-box"},c.a.createElement("div",{className:"popup-heading"},"Do you want to delete review ?"),c.a.createElement("div",{className:"popup-btn"},c.a.createElement("button",{className:"danger-btn",onClick:t},"Delete"),c.a.createElement("button",{className:"cancel-btn",onClick:n},"Cancel"))))},x=function(e){var t=Object(a.useState)(!1),n=Object(o.a)(t,2),r=n[0],l=n[1],i=function(){l(!r)};return c.a.createElement("div",null,r&&c.a.createElement(C,{onDelete:e.onClick,onCancel:i}),c.a.createElement("img",{className:"review-delete-btn",onClick:i,src:N.a,alt:"Delete review"}))},S=function(e){var t=Object(a.useState)(e.reviewText),n=Object(o.a)(t,2),r=n[0],l=n[1];return c.a.createElement("div",{className:"update-review-container"},c.a.createElement("textarea",{value:r,className:"post-review-textArea",onChange:function(e){l(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("button",{className:"update-review-btn",onClick:function(){return e.updateReview(r)}},"Update Review"),c.a.createElement("button",{className:"cancel-review-btn",onClick:e.cancelEditMode},"Cancel")))},B=n(18),R=n.n(B),L=function(e){var t=e.reviewid,n=e.username,r=e.reviewtext,l=e.reviewdate,i=Object(a.useState)(!1),u=Object(o.a)(i,2),s=u[0],d=u[1],v=Object(a.useContext)(m),f=Object(o.a)(v,1)[0],b=f.isLogin,E=f.user,p=function(){d(!s)},h=s?c.a.createElement(S,{reviewText:r,updateReview:function(n){k(t,n).then((function(){e.updateReview(),p()}))},cancelEditMode:p}):c.a.createElement("div",{className:"review-text"},r);return c.a.createElement("div",{className:"review-box"},c.a.createElement("div",{className:"review-header"},c.a.createElement("b",null,c.a.createElement("i",null,n)),b&&E.login===n&&c.a.createElement("div",{className:"review-action-btn"},c.a.createElement(x,{onClick:function(){w(t).then((function(){e.updateReview()}))}}),c.a.createElement("img",{className:"review-edit-btn",onClick:p,src:R.a,alt:"Edit review"}))),h,c.a.createElement("div",{className:"review-time"},c.a.createElement("span",null,new Date(l).toUTCString())))},y=function(e){var t=e.bookId,n=Object(a.useState)(""),r=Object(o.a)(n,2),l=r[0],i=r[1];return c.a.createElement("div",{className:"post-review-container"},c.a.createElement("textarea",{value:l,className:"post-review-textArea",onChange:function(e){i(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("button",{className:"post-review-btn",onClick:function(){g(t,l).then((function(){e.updateReview(),i("")}))}},"Post Review")))},I=function(e){var t=Object(a.useContext)(m),n=Object(o.a)(t,1)[0],r=Object(u.g)().bookId,l=Object(a.useState)({}),i=Object(o.a)(l,2),s=i[0],d=i[1],v=Object(a.useState)([]),f=Object(o.a)(v,2),E=f[0],w=f[1],g=Object(a.useState)(""),k=Object(o.a)(g,2),j=k[0],O=k[1],N=function(){p(r).then(w)};return Object(a.useEffect)((function(){b(r).then(d),p(r).then(w)}),[r]),Object(a.useEffect)((function(){s.frontimage&&h(s.frontimage).then(O)}),[s.frontimage]),c.a.createElement("div",null,c.a.createElement("div",{className:"book-container"},c.a.createElement("img",{src:j,alt:s.title}),c.a.createElement("div",{className:"detail"},c.a.createElement("h2",null,s.title),c.a.createElement("p",null,"by ",s.writer),c.a.createElement("p",null,E.length," review",E.length>1?"s":""))),c.a.createElement("div",{className:"review-container"},E.map((function(e){return c.a.createElement(L,Object.assign({key:e.reviewid},e,{updateReview:N}))}))),c.a.createElement("div",null,n.isLogin&&c.a.createElement(y,{bookId:r,updateReview:N})))},D=function(e){return c.a.createElement("div",{className:e.className},c.a.createElement("input",{type:"text",value:e.value,placeholder:"Search Books..",onChange:function(t){return e.onChange(t.target.value)}}))},P=function(e){var t=e.id,n=e.frontimage,r=e.title,l=Object(a.useState)(""),u=Object(o.a)(l,2),s=u[0],m=u[1];return Object(a.useEffect)((function(){h(n).then(m)}),[n]),c.a.createElement("div",{className:"book-card"},c.a.createElement(i.b,{to:"/book/".concat(t)},c.a.createElement("img",{src:s,alt:"Avatar",className:"book-card-img"})),c.a.createElement("div",{className:"book-detail"},c.a.createElement("h4",null,c.a.createElement("b",null,r))))},T=function(e){var t=e.bookList;if(0===t.length)return c.a.createElement("div",{className:"book-list-container"},c.a.createElement("h3",null,"Book not found."));var n=t.map((function(e){return c.a.createElement(P,Object.assign({},e,{key:e.id}))}));return c.a.createElement("div",{className:"book-list-container"},n)},A=function(e){var t=Object(a.useState)([]),n=Object(o.a)(t,2),r=n[0],l=n[1],i=Object(a.useState)(""),u=Object(o.a)(i,2),s=u[0],m=u[1];Object(a.useEffect)((function(){f().then(l)}),[]);var d;return c.a.createElement("div",null,c.a.createElement(D,{onChange:function(e){m(e)},className:"book-search-bar"}),c.a.createElement(T,{bookList:(d=s,r.filter((function(e){return e.title.toLowerCase().includes(d.toLowerCase())})))}))},J=function(e){return c.a.createElement("div",{class:"container"},c.a.createElement(A,null))},U=function(e){var t=Object(a.useState)(""),n=Object(o.a)(t,2),r=n[0],l=n[1],i=Object(a.useState)(""),s=Object(o.a)(i,2),m=s[0],d=s[1],v=Object(a.useState)(""),f=Object(o.a)(v,2),b=f[0],E=f[1],p=Object(a.useState)(null),h=Object(o.a)(p,2),w=h[0],g=h[1],k=Object(u.f)(),j=function(e,t){t(e)};return c.a.createElement("div",{class:"add-book-container"},c.a.createElement("form",{id:"contact",action:"",method:"post"},c.a.createElement("h3",null,"Add Book"),c.a.createElement("fieldset",null,c.a.createElement("input",{placeholder:"Book Title",type:"text",value:r,onChange:function(e){return j(e.target.value,l)}})),c.a.createElement("fieldset",null,c.a.createElement("input",{placeholder:"Book Writer",type:"text",value:m,onChange:function(e){return j(e.target.value,d)},tabindex:"2",required:!0})),c.a.createElement("fieldset",null,c.a.createElement("textarea",{placeholder:"Book Description",value:b,onChange:function(e){return j(e.target.value,E)},tabindex:"5",required:!0})),c.a.createElement("fieldset",null,c.a.createElement("label",null,"Book Cover : "),c.a.createElement("input",{placeholder:"Book cover",type:"file",onChange:function(e){return j(e.target.files[0],g)},tabindex:"4",required:!0})),c.a.createElement("fieldset",null,c.a.createElement("button",{name:"button",onClick:function(){var e=new FormData;e.append("title",r),e.append("writer",m),e.append("description",b),e.append("bookimage",w),fetch("/api/addBook",{method:"post",body:e}).then((function(e){console.log("added"),k.push("/")}))},type:"button"},"Add Book"))))},q=function(){return c.a.createElement(i.a,null,c.a.createElement(j,null),c.a.createElement(u.c,null,c.a.createElement(u.a,{exact:!0,path:"/"},c.a.createElement(J,null)),c.a.createElement(u.a,{path:"/book/:bookId"},c.a.createElement(I,null)),c.a.createElement(u.a,{path:"/addBook"},c.a.createElement(U,null))))};var M=function(){var e=Object(a.useState)({isLogin:!1,user:null}),t=Object(o.a)(e,2),n=t[0],r=t[1];return c.a.createElement(m.Provider,{value:[n,r]},c.a.createElement(q,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.a42ab4a3.chunk.js.map