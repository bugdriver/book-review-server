(this["webpackJsonpbook-review"]=this["webpackJsonpbook-review"]||[]).push([[0],{17:function(e,t,n){e.exports=n.p+"static/media/delete.650cdc57.svg"},18:function(e,t,n){e.exports=n.p+"static/media/pencil.aa0b5ae2.svg"},19:function(e,t,n){e.exports=n(31)},24:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(15),i=n.n(r),l=(n(24),n(3)),o=n(7),u=n(1),s=function(e){return c.a.createElement("div",null,c.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=48185bdb82c854d22f89"},"Login"))},m=function(e){var t=e.loginDetails;if(t.isLogin){var n=t.user;return c.a.createElement("div",{className:"navbar"},c.a.createElement("div",null,c.a.createElement(o.b,{to:"/"},c.a.createElement("h3",null,"Reader's Junction"))),c.a.createElement("div",null,c.a.createElement("button",{className:"btnlink",onClick:e.handleLogout},"Logout"),c.a.createElement("span",null,n.login)))}return c.a.createElement("div",{className:"navbar"},c.a.createElement("div",null,c.a.createElement(o.b,{to:"/"},c.a.createElement("h3",null,"Reader's Junction"))),c.a.createElement("div",null,c.a.createElement(s,null)))},v=function(e,t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},d=function(){return new Promise((function(e,t){fetch("/api/getUser").then((function(n){var a=n.json();403!==n.status?e(a):t(a)})).catch((function(e){t(e)}))}))},f=function(){return new Promise((function(e,t){fetch("/api/getBooks").then((function(t){e(t.json())}))}))},E=function(e){return new Promise((function(t,n){fetch("/api/getBook?bookId=".concat(e)).then((function(e){t(e.json())})).catch((function(e){n(e)}))}))},b=function(){return v("/api/logout")},w=function(e){return new Promise((function(t,n){fetch("/api/getReviewOfBook?bookId=".concat(e)).then((function(e){t(e.json())}))}))},h=function(e){return fetch(e).then((function(e){return e.blob()})).then((function(e){return function(e){return new Promise((function(t,n){var a=new FileReader;a.onerror=n,a.onload=function(){t(a.result)},a.readAsDataURL(e)}))}(e)}))},p=function(e){return v("/api/deleteReview",{reviewId:e})},g=function(e,t){return v("/api/addReview",{bookId:e,reviewText:t})},k=function(e,t){return v("/api/updateReview",{reviewId:e,reviewText:t})},j=(n(30),function(e){var t=e.id,n=e.frontimage,r=e.title,i=Object(a.useState)(""),u=Object(l.a)(i,2),s=u[0],m=u[1];return Object(a.useEffect)((function(){h(n).then(m)}),[n]),c.a.createElement("div",{className:"book-card"},c.a.createElement(o.b,{to:"/book/".concat(t)},c.a.createElement("img",{src:s,alt:"Avatar",className:"book-card-img"})),c.a.createElement("div",{className:"book-detail"},c.a.createElement("h4",null,c.a.createElement("b",null,r))))}),N=function(e){var t=Object(a.useState)([]),n=Object(l.a)(t,2),r=n[0],i=n[1];Object(a.useEffect)((function(){f().then(i)}),[]);var o=r.map((function(e){return c.a.createElement(j,Object.assign({},e,{key:e.id}))}));return c.a.createElement("div",{className:"book-list-container"},o)},O=n(17),C=n.n(O),R=function(e){var t=e.onDelete,n=e.onCancel;return c.a.createElement("div",{className:"modal"},c.a.createElement("div",{className:"popup-box"},c.a.createElement("div",{className:"popup-heading"},"Do you want to delete review ?"),c.a.createElement("div",{className:"popup-btn"},c.a.createElement("button",{className:"danger-btn",onClick:t},"Delete"),c.a.createElement("button",{className:"cancel-btn",onClick:n},"Cancel"))))},x=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),r=n[0],i=n[1],o=function(){i(!r)};return c.a.createElement("div",null,r&&c.a.createElement(R,{onDelete:e.onClick,onCancel:o}),c.a.createElement("img",{className:"review-delete-btn",onClick:o,src:C.a,alt:"Delete review"}))},S=function(e){var t=Object(a.useState)(e.reviewText),n=Object(l.a)(t,2),r=n[0],i=n[1];return c.a.createElement("div",{className:"update-review-container"},c.a.createElement("textarea",{value:r,className:"post-review-textArea",onChange:function(e){i(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("button",{className:"update-review-btn",onClick:function(){return e.updateReview(r)}},"Update Review"),c.a.createElement("button",{className:"cancel-review-btn",onClick:e.cancelEditMode},"Cancel")))},I=n(18),L=n.n(I),y=function(e){var t=e.reviewid,n=e.username,r=e.reviewtext,i=e.reviewdate,o=Object(a.useState)(!1),u=Object(l.a)(o,2),s=u[0],m=u[1],v=function(){m(!s)},d=s?c.a.createElement(S,{reviewText:r,updateReview:function(n){k(t,n).then((function(){e.updateReview(),v()}))},cancelEditMode:v}):c.a.createElement("div",{className:"review-text"},r);return c.a.createElement("div",{className:"review-box"},c.a.createElement("div",{className:"review-header"},c.a.createElement("b",null,c.a.createElement("i",null,n)),c.a.createElement("div",{className:"review-action-btn"},c.a.createElement(x,{onClick:function(){p(t).then((function(){e.updateReview()}))}}),c.a.createElement("img",{className:"review-delete-btn",onClick:v,src:L.a,alt:"Edit review"}))),d,c.a.createElement("div",{className:"review-time"},c.a.createElement("span",null,new Date(i).toUTCString())))},D=function(e){var t=e.bookId,n=Object(a.useState)(""),r=Object(l.a)(n,2),i=r[0],o=r[1];return c.a.createElement("div",{className:"post-review-container"},c.a.createElement("textarea",{value:i,className:"post-review-textArea",onChange:function(e){o(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("button",{className:"post-review-btn",onClick:function(){g(t,i).then((function(){e.updateReview(),o("")}))}},"Post Review")))},P=function(e){var t=Object(u.f)().bookId,n=Object(a.useState)({}),r=Object(l.a)(n,2),i=r[0],o=r[1],s=Object(a.useState)([]),m=Object(l.a)(s,2),v=m[0],d=m[1],f=Object(a.useState)(""),b=Object(l.a)(f,2),p=b[0],g=b[1],k=function(){w(t).then(d)};return Object(a.useEffect)((function(){E(t).then(o),w(t).then(d)}),[t]),Object(a.useEffect)((function(){i.frontimage&&h(i.frontimage).then(g)}),[i.frontimage]),c.a.createElement("div",null,c.a.createElement("div",{className:"book-container"},c.a.createElement("img",{src:p,alt:i.title}),c.a.createElement("div",{className:"detail"},c.a.createElement("h2",null,i.title),c.a.createElement("p",null,"by ",i.writer),c.a.createElement("p",null,v.length," review",v.length>1?"s":""))),c.a.createElement("div",{className:"review-container"},v.map((function(e){return c.a.createElement(y,Object.assign({key:e.reviewid},e,{updateReview:k}))}))),c.a.createElement("div",null,c.a.createElement(D,{bookId:t,updateReview:k})))};var T=function(){var e=Object(a.useState)({isLogin:!1,user:null}),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){d().then((function(e){e&&r({isLogin:!0,user:e})}))}),[n.isLogin]),c.a.createElement(o.a,null,c.a.createElement(m,{loginDetails:n,handleLogout:function(){b().then((function(){r({isLogin:!1,user:null})}))}}),c.a.createElement(u.c,null,c.a.createElement(u.a,{exact:!0,path:"/"},c.a.createElement("div",null,c.a.createElement(N,null))),c.a.createElement(u.a,{path:"/book/:bookId"},c.a.createElement(P,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.062efe10.chunk.js.map